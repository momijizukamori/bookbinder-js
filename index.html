<!-- This Source Code Form is subject to the terms of the Mozilla Public
   - License, v. 2.0. If a copy of the MPL was not distributed with this
   - file, You can obtain one at https://mozilla.org/MPL/2.0/. -->

<!doctype html>
<html>
  <head>
    <title>Bookbinder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/balloon-css/balloon.min.css" />
    <link rel="stylesheet" type="text/css" href="./styles.css" />
    <link rel="stylesheet" href="./matcha.css" />
    <link rel="icon" type="image/x-icon" href="https://momijizukamori.github.io/bookbinder-js/favicon.ico" />
    <meta charset="UTF-8" />
    <script type="module" crossorigin src="https://momijizukamori.github.io/bookbinder-js/assets/index-EJpvSWwq.js"></script>
  </head>

  <body>
    <div class="wrapper">
      <div class="section" id="intro">
        <h1>Bookbinder JS</h1>
        A Javascript-based app for formatting PDFs for bookbinding-- a process called imposition.
        For more information, feature requests, or to contribute, view the project's
        <a href="https://github.com/momijizukamori/bookbinder-js">Github repository</a>. If you have
        issues with this version, you can try the
        <a href="https://momijizukamori.github.io/bookbinder-js/old/index.html">old version</a> instead, which only supports folio
        layouts.
        <center style="font-family: monospace; padding-top: 0.75em; font-variant-caps: small-caps">
          current version: 1.6.1
        </center>
      </div>
      <form id="bookbinder" name="bookbinder">
        <section class="section" id="input">
  <header><h2>File Info</h2></header>
  <label
    >Input File: <input type="file" name="input_file" accept=".pdf" id="input_file" class="inline"
  /></label>
  <!-- <span class="row"><label>Page Size: <span id="page_size"></span></span> -->
  <!-- <span class="row">Page Ratio: <span id="input_ratio"></span></span> -->
  <p class="flash variant">
    While some PDF viewers display the first two pages as a spread, be aware the first page, which
    is odd, will be on the right when printed. The first printed spread are pages 2 & 3 of your PDF
    document. Evens always on the left, odds always on the right.
  </p>
  <label for="print_file"
    >Generated Files:
    <select name="print_file" id="print_file" class="inline">
      <option value="aggregated">Aggregated File Only</option>
      <option value="both" selected>Both aggregated & per signature files</option>
      <option value="signatures">Signature Files Only</option>
    </select>
  </label>
</section>

        <section class="section" id="input">
  <header><h2>Source Manipulation</h2></header>
  <label for="source_rotation" class="mb-1"
    >Style:
    <select name="source_rotation" id="source_rotation" class="inline">
      <option id="none" value="none" selected="selected">no modification</option>
      <option id="90cw" value="90cw">rotate pages 90° clockwise</option>
      <option id="90ccw" value="90ccw">rotate pages 90° counter clockwise</option>
      <option id="out_binding" value="out_binding">
        odd pages 90° clockwise, even pages 90° anti-clockwise
      </option>
      <option id="in_binding" value="in_binding">
        odd pages 90° anti-clockwise, even pages 90° clockwise
      </option>
    </select>
  </label>

  <div id="none_example" class="row source_rotation_example flash variant small flex center">
    <img src="https://momijizukamori.github.io/bookbinder-js/img/noRotationDiagram.png" width="100px" />
    <p>
      <br />
      For books that read like a standard novel<br />
      no rotation of pages applied
    </p>
  </div>
  <div id="90cw_example" class="hidden source_rotation_example flash variant small flex center">
    <img src="https://momijizukamori.github.io/bookbinder-js/img/90cwDiagram.png" width="100px" />
    <p>
      <br />
      For books that turn pages like a calender<br />
      back to front, rotate all pages 90° clockwise
    </p>
  </div>
  <div id="90ccw_example" class="hidden source_rotation_example flash variant small flex center">
    <img src="https://momijizukamori.github.io/bookbinder-js/img/90ccwDiagram.png" width="100px" />
    <p>
      <br />
      For books that turn pages like a calender<br />
      front to back, rotate all pages 90° counter clockwise
    </p>
  </div>
  <div
    id="out_binding_example"
    class="hidden source_rotation_example row flash variant small flex center"
  >
    <img src="https://momijizukamori.github.io/bookbinder-js/img/bottomBindingDiagram.png" width="100px" />
    <p>
      <br />
      For books with bound edge at bottom of the page<br />
      rotate all odd pages 90° clockwise, all even pages 90° anti-clockwise
    </p>
  </div>
  <div
    id="in_binding_example"
    class="hidden source_rotation_example flash variant small flex center"
  >
    <img src="https://momijizukamori.github.io/bookbinder-js/img/topBindingDiagram.png" width="100px" />
    <p>
      <br />
      For books with bound edge at top of the page<br />
      rotate all odd pages 90° anti-clockwise, all even pages 90° clockwise
    </p>
  </div>
</section>

        <section class="section" id="printer_info">
  <header><h2>Printer</h2></header>
  <label for="paper_size"
    >Paper size:
    <select name="paper_size" id="paper_size" class="inline"></select
  ></label>
  <div class="ml-2 input-group">
    <label for="paper_size_unit"
      >Display unit for paper selection:
      <select name="paper_size_unit" id="paper_size_unit" class="inline">
        <option label="Points" value="pt" />
        <option label="Inches" value="in" />
        <option label="Centimeters" value="cm" />
      </select>
    </label>
    <label for="paper_size_unit" class="mb-1"
      >Dimensions for CUSTOM:
      <input
        type="number"
        id="paper_size_custom_width"
        name="paper_size_custom_width"
        class="inline"
      />
      x
      <input
        type="number"
        id="paper_size_custom_height"
        name="paper_size_custom_height"
        class="inline"
      />
      (in Points)
      <span
        data-balloon-length="medium"
        aria-label="The CUSTOM option in drop down will only appear if valid dimensions are provided. Points are the unit the system/code works in. Luckily Google can help you convert cm or inches into Points quite easily!"
        data-balloon-pos="up"
        >ℹ️</span
      >
    </label>
  </div>

  <label for="printer_type"
    >Printer type:
    <select name="printer_type" id="printer_type" class="inline">
      <option value="single" selected>Single-Sided</option>
      <option value="duplex">Duplex</option>
    </select>
    <span
      data-balloon-length="medium"
      aria-label="Duplex will alternate front and backs of sheets in a single file; Single-sided will split fronts and backs into seperate files."
      data-balloon-pos="up"
      >ℹ️</span
    ></label
  >
  <label for="paper_rotation_90"
    >Rotate Paper 90°: <input type="checkbox" name="paper_rotation_90" id="paper_rotation_90" />
    <span
      data-balloon-length="medium"
      aria-label="This puts your paper in 'landscape' -- layout still happens the same, but the porportions of things will be different"
      data-balloon-pos="up"
      >ℹ️</span
    ></label
  >

  <label class="mb-1"
    >Alternate Page Rotation (AKA Flip on Long Side):<input type="checkbox" name="rotate_page"
  /></label>
  <p class="flash attention" id="folio_warning">
    <b>NOTE:</b> Not currently working for folios, sorry! Use the
    <a href="https://momijizukamori.github.io/bookbinder-js/old/index.html">old version</a>
    for now.
  </p>
</section>

        <section class="section" id="book_size">
  <header><h2>Page Layout</h2></header>
  <label for="pagelayout" class="mb-1"
    >Style:
    <select name="pagelayout" id="pagelayout" class="inline">
      <option id="folio" value="folio">Folio - two pages per side of sheet</option>
      <option id="quarto" value="quarto" selected>Quarto - four pages per side of sheet</option>
      <option id="octavo" value="octavo">Octavo - eight pages per side of sheet</option>
      <option id="sextodecimo" value="sextodecimo">
        Sextodecimo - sixteen pages per side of sheet
      </option>
    </select>
  </label>
  <details>
    <summary>Folding instructions for quarto/octavo</summary>
    <p>
      Folding these two layouts is slightly more complex than the simple single-fold folio. Both of
      these have been designed so that the first fold is parallel to the short edge of the paper -
      eg, if you hold the page in portrait orientation, you will be folding the top edge to the
      bottom. One side of the page will have consecutive numbers across this fold (ie, 3 and 30 on
      the top row, 2 and 31). Fold inward across this line (so that 3 has been folded to lay against
      2, and 30 against 31). The next fold is along the other paper axis (parallel to the original
      long edge). For quarto, you want to find the side with the numbers closest together, and fold
      inwards to match them (this will be consecutive on the innermost sheet). For octavo, look at
      the bottom-most row and find the consecutive pair, then fold inward. Octavo has one last fold,
      for which you want to find the pair remaning that are closest, and fold them together.
    </p>
    <p>
      Or, if you want to just memorize the order, once you find the first fold side, the order
      is:<br />
      <b>quarto</b> - top to bottom, fold points away from you, left to right, fold points towards
      you.<br />
      <b>octavo</b> - top to bottom, fold points away from you, left to right, fold points away from
      you, top to bottom, fold points towards you.
    </p>
  </details>

  <label for="page_scaling"
    >Page scaling:
    <select name="page_scaling" id="page_scaling" class="inline">
      <option value="centered">Original</option>
      <option value="lockratio" selected>Keep proportional</option>
      <option value="stretch">Stretch to fit</option>
    </select>
  </label>

  <label for="page_positioning"
    >Page Positioning:
    <select name="page_positioning" id="page_positioning" class="inline">
      <option value="centered" selected>Centered</option>
      <option value="binding_aligned">Snug against binding edge</option>
    </select>
  </label>

  <span class="flex space-evenly align-center layout_margin_user_input">
    <div class="input-group ml-2 mt-1">
      <label>
        Fore-Edge Margin:
        <input
          type="number"
          id="main_fore_edge_padding_pt"
          name="main_fore_edge_padding_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >
      <label
        >Binding Margin:
        <input
          type="number"
          id="binding_edge_padding_pt"
          name="binding_edge_padding_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >
      <label
        >Top Margin:
        <input
          type="number"
          id="top_edge_padding_pt"
          name="top_edge_padding_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >
      <label
        >Bottom Margin:
        <input
          type="number"
          id="bottom_edge_padding_pt"
          name="bottom_edge_padding_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >
    </div>
    <div class="small shrink" style="max-width: 15em">
      White Space Manipulation. All values are in points, relative to original document.<br /><br />1
      point = 1/72 inch
    </div>
  </span>

  <span class="flex center mt-2 small" id="show_layout_info">
    <div>
      <div class="layout_spine_label">spine</div>
      <div class="stripes_paper" id="grid_layout_preview">
        <div class="stripes_pdf" id="pdf_on_page_layout_preview"></div>
      </div>
    </div>
    <div class="layout_margin_info ml-4" id="layout_margin_info">
      <div class="stripes_paper stripes_sample_box"></div>
      <b>Paper/Layout Dimensions</b>
      Layout: <span id="page_grid_layout"></span><br />
      Max page size:
      <span id="page_grid_dimensions"></span><br />
      <br />
      <div class="stripes_pdf stripes_sample_box"></div>
      <b>PDF Dimensions</b><br />
      Source: <span id="pdf_source_dimensions"></span><br />
      On page: <span id="pdf_page_dimensions"></span><br />
      Scaling: <span id="pdf_scale_dimensions"></span><br />
      Offset:
      <div class="inline">
        <div id="pdf_offset_dimensions"></div>
      </div>
      <br />
      Rotated: <span id="pdf_page_rotation_info"></span><br />
      <br />
      (<i>All dimensions are in Points</i>)
    </div>
  </span>
</section>

        <section class="section">
  <h2>PDF Markup</h2>
  <p class="flash attention small">(does not currently work with Wacky Small Layouts -- soon!)</p>
  <label
    >Add Foldlines:
    <input type="checkbox" name="cropmarks" />
    <span
      data-balloon-length="medium"
      aria-label="Adds folding guidelines (ordered thickest to thinnest)"
      data-balloon-pos="up"
      >ℹ️
    </span>
  </label>
  <label
    >Add Cutlines: <input type="checkbox" name="cutmarks" />
    <span data-balloon-length="medium" aria-label="Adds cutting guidelines" data-balloon-pos="up">
      ℹ️</span
    >
  </label>
  <label
    >Add PDF bounds indicators (spine):
    <input type="checkbox" name="pdf_edge_marks" />
    <span
      data-balloon-length="medium"
      aria-label="Puts small marks on the outermost folio of the signatures indicating the top and bottom of the PDF"
      data-balloon-pos="up"
    >
      ℹ️</span
    >
  </label>
  <label
    >Add signature order marks (spine):
    <input type="checkbox" name="sig_order_marks" />
    <span
      data-balloon-length="medium"
      aria-label="Puts staggered lines down the different signature spines to indicate order"
      data-balloon-pos="up"
      >ℹ️</span
    >
  </label>
  <label class="mb-1"
    >Add marks for sewing:
    <input type="checkbox" id="add_sewing_marks_checkbox" name="add_sewing_marks_checkbox"
  /></label>

  <details id="sewing_marks_details">
    <summary>Detailed settings for sewing</summary>
    <label
      >Draw marks on:
      <select name="sewing_mark_locations" id="sewing_mark_locations" class="inline">
        <option value="all" selected="selected">center of every folio</option>
        <option value="only_out">only on spine</option>
        <option value="only_in">only in center of signature</option>
        <option value="in_n_out">both spine and center of signature</option>
      </select>
    </label>
    Look at the image below.<br />
    <div class="input-group ml-2">
      <label
        >(A) Margin (distance where first point should be draw):
        <input
          type="number"
          id="sewing_marks_margin_pt"
          name="sewing_marks_margin_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >

      <label
        >(B) Amount of sewing points:
        <input
          type="number"
          id="sewing_marks_amount"
          name="sewing_marks_amount"
          class="layout_margin_user_input_field inline"
      /></label>

      <label
        >(C) Tape width:
        <input
          type="number"
          id="sewing_marks_tape_width_pt"
          name="sewing_marks_tape_width_pt"
          class="layout_margin_user_input_field inline"
        />pt</label
      >
    </div>
    <img
      alt="sewing image - use tape width of 0pt to make a single dot (overlapping marks)"
      src="https://momijizukamori.github.io/bookbinder-js/img/sewing_settings_explanation.png"
      style="height: 100%; width: 100%; object-fit: contain"
    />
  </details>
</section>

        <section class="section" id="sig_format">
  <header><h2>Signature Format</h2></header>

  <label>
    <input type="radio" id="booklet" name="sig_format" value="booklet" />
    Booklet</label
  >

  <label for="perfect">
    <input type="radio" id="perfect" name="sig_format" value="perfect" />
    Perfectbound</label
  >

  <label for="standardsig"
    ><input type="radio" id="standardsig" name="sig_format" value="standardsig" checked /> Standard
    signatures - length <input type="number" value="8" name="sig_length" class="inline" />
    <span
      data-balloon-length="medium"
      aria-label="Number of sheets per signature"
      data-balloon-pos="up"
      >ℹ️</span
    ></label
  >

  <label for="customsig" class="mb-1">
    <input type="radio" id="customsig" name="sig_format" value="customsig" />Custom signatures
    <input type="text" name="custom_sig" class="inline" />

    <span
      data-balloon-length="medium"
      aria-label="Specify as a set of numbers seperated by commas, such as: 10, 10, 8"
      data-balloon-pos="up"
      >ℹ️</span
    >
  </label>
  <details>
    <summary>A note on calculating signature lengths</summary>
    <p>
      In this code, the length of a signature is the number of full-sized sheets of paper per
      signature. For a folio book, this means that the number of folds you punch through when sewing
      together a signature is the same as the number of sheets in the signature, as each sheet has
      one fold. For quarto, this will be two folds for each sheet - octavo, four; sextodecimo,
      eight. Calculate your signature lengths accordingly (in particular, you almost certainly don't
      want more than one sheet for sextodecimo).
    </p>
  </details>
  <h3>Wacky Small Layouts</h3>
  <p class="flash variant">
    These layouts contain one or more signature per printed page. They use only the "File Info" and
    "Printer" settings. The names are arbitrary and hold no standardized meaning.
  </p>
  <div class="flex space-evenly">
    <label class="centered"
      >Fore-Edge Padding: <br /><input
        type="number"
        id="fore_edge_padding_pt"
        name="fore_edge_padding_pt"
        class="inline"
      />pt</label
    >
    <div>
      <label for="wacky_pack"
        ><input
          type="radio"
          id="wacky_pack"
          name="wacky_spacing"
          value="wacky_pack"
          checked
        />Packed page layout</label
      >
      <label for="wacky_gap"
        ><input type="radio" id="wacky_gap" name="wacky_spacing" value="wacky_gap" />Distributed
        space page layout</label
      >
    </div>
  </div>

  <label for="1_3rd">
    <input type="radio" id="1_3rd" name="sig_format" value="1_3rd" />6 per side
    <small>(3 folio signature)</small></label
  >

  <details class="ml-2">
    <summary>Instructions</summary>
    <p>
      Cut along the lines <i>or</i> cut just extra bit off the top (along exposed "top" of page) and
      then fold up along the dotted lines (if trimming, you can just trim off the cruft at the
      bottom-- tops need to be even for leveling purposes however). Outer margins intentionally
      under-marked so you can trim wherever feels right after folding & assembly.
    </p>
    <p>
      Not the most paper efficient of layouts, but it's optimized for organization (if a signature
      is just one page, harder to botch the ordering) and many, smaller signatures make for rounder
      backs and large swell in my [six's] opinion (which helps w/ nice shoulders, if you're into
      that sort of thing)
    </p>
  </details>

  <label for="A7_2_16s"
    ><input type="radio" id="A7_2_16s" name="sig_format" value="A7_2_16s" /> Petite - 16 per side
    <small>(4 folio signature x 2)</small></label
  >

  <details class="ml-2">
    <summary>Instructions</summary>
    <p>
      <center>
        <img src="https://momijizukamori.github.io/bookbinder-js/img/2_sig_4x4_diagram.png" />
      </center>
      Cut the vertical center line. You can also cut the horizontal lines if you like, or just fold
      it up as detailed above.
    </p>
  </details>

  <label for="8_zine">
    <input type="radio" id="8_zine" name="sig_format" value="8_zine" /> Single Sheet Zine - 8 per
    side <small>(one sided printed page foldup)</small></label
  >
  <details class="ml-2">
    <summary>Instructions</summary>
    <p>
      The classic no-cut, single page zine! Just fold it up right and you've got yourself a mutant
      non-standard folio making an 8 page little fellow-- all extra pages beyond 8 are discarded.
      For better folding instructions than I could possibly write, see:
      <a href="https://www.quarantinepubliclibrary.com/tutorial"
        >https://www.quarantinepubliclibrary.com/tutorial</a
      >
    </p>
  </details>
  <label for="a_3_6s"
    ><input type="radio" id="a_3_6s" name="sig_format" value="a_3_6s" />Small - 18 per side
    <small>(3 folio signature per row x 3)</small></label
  >
  <details class="ml-2">
    <summary>Instructions</summary>
    <p class="flash attention">
      THIS IS A LANDSCAPE LAYOUT. IT MUST BE PRINTED AND "flipped on the short side" (the
      non-typical flipping)
    </p>

    <p>
      Remember to do a single-sheet test print if it's your first time to make sure duplex/mirroring
      is correct!
    </p>
    <p>
      Cut out the rows. Fold up the folios like a zig-zag (two per face). Then fold the center of
      the text (smoosh the two matching page numbers together).
    </p>
    <p>
      Note that when folding, it's important for the
      <b>center of the folios to line up</b>. That's what I measure against (less so fretting about
      folding exactly at the edge). Remember! Printer skew is a real thing!
    </p>
  </details>

  <label for="a9_3_3_4">
    <input type="radio" id="a9_3_3_4" name="sig_format" value="a9_3_3_4" />Little - 20 per side
    <small>(3 folio / 3 folio / 4 folio signatures)</small></label
  >

  <details class="ml-2">
    <summary>Instructions</summary>
    <p>
      <center>
        <img src="https://momijizukamori.github.io/bookbinder-js/img/3_3_4_diagram.png" />
      </center>
      Cut along the cut lines. Fold up the 3 folio signatures, then the 4 folio.
    </p>
  </details>

  <label for="a_4_8s"
    ><input type="radio" id="a_4_8s" name="sig_format" value="a_4_8s" />Tiny - 32 per side
    <small>(4 folio signature per row x 4)</small></label
  >

  <details class="ml-2">
    <summary>Instructions</summary>
    <p class="flash attention">
      THIS IS A LANDSCAPE LAYOUT. IT MUST BE PRINTED AND "flipped on the short side" (the
      non-typical flipping)
    </p>
    <p>
      Remember to do a single-sheet test print if it's your first time to make sure duplex/mirroring
      is correct!
    </p>
    <p>
      Cut out the rows. Fold up the folios like a zig-zag (two per face). Then fold the center of
      the text (smoosh the two matching page numbers together).
    </p>
    <p>
      Note that when folding, it's important for the
      <b>center of the folios to line up</b>. That's what I measure against (less so fretting about
      folding exactly at the edge). Remember! Printer skew is a real thing!
    </p>
  </details>

  <label for="a10_6_10s"
    ><input type="radio" id="a10_6_10s" name="sig_format" value="a10_6_10s" />Mini - 60 per side
    <small>(2 folio / 3 folio signatures per row x 6)</small></label
  >
  <details class="ml-2">
    <summary>Instructions</summary>
    <p class="flash attention">
      THIS IS A LANDSCAPE LAYOUT. IT MUST BE PRINTED AND "flipped on the short side" (the
      non-typical flipping)
    </p>
    <p>
      Thankfully most small layouts fit on one page-- easy enough to do a test print and make sure
      you're duplexing correctly (if that's your route)
    </p>
    <p>
      <center>
        <img src="https://momijizukamori.github.io/bookbinder-js/img/6_10s_diagram.png" />
      </center>
      Cut out the rows. Fold up the folios like a big zig-zag (two per face). Then fold the first 2
      folios into a signature and the last 3 folios into a signature. I often cut them apart only
      when I'm stitching things together.
    </p>
    <p>
      Note that when folding, it's important for the
      <b>center of the folios to line up</b>. That's what I measure against (less so fretting about
      folding exactly at the edge). Remember! Printer skew is a real thing!
    </p>
  </details>
</section>

        <section class="section" id="flyleaf_info">
  <header><h2>Flyleafs</h2></header>
  <label
    >Add flyleafs: <input type="number" name="flyleafs" value="1" class="inline" />
    <span
      data-balloon-length="medium"
      aria-label="Extra blank pages at the start and end of the book"
      data-balloon-pos="up"
      >ℹ️</span
    ></label
  >
</section>

        <section class="section" id="sig_info">
  <header><h2>Signature Info</h2></header>

  <center>
    <iframe id="pdf" style="width: 100%; height: 10px; display: none"></iframe>
  </center>
  <div class="space_out">
    <span>Total Pages: <span id="total_pages"></span></span>
    <span>Original PDF Pages: <span id="page_count"></span></span>
  </div>
  <div class="space_out">
    <span>Total Sheets: <span id="total_sheets"></span></span>
    <span>Number of Signatures: <span id="sig_count"></span></span>
  </div>
  <div>
    <div style="text-align: center">Signature Arrangement:</div>
    <div id="sig_arrange" style="text-align: center"></div>
  </div>
</section>

        <div class="flex space-between align-center pb-2">
  <button
    type="button"
    name="preview"
    id="preview"
    disabled
    data-balloon-length="medium"
    aria-label="Will not show previews if 'Signature Files Only' is selected. Only shows one side for 'Single Sided' printing. Not tested on all browsers (or any browsers other than Chrome really...)"
    data-balloon-pos="right"
    class="small p-1"
  >
    Preview PDF
  </button>
  <button type="button" class="larger p-1" name="generate" id="generate" disabled>
    Generate PDF Output
  </button>
  <button
    type="reset"
    name="reset_settings"
    id="reset_settings"
    data-balloon-length="medium"
    aria-label="The page is able to save and load your current settings via the site URL. Clicking this button will reset those to the default settings"
    data-balloon-pos="left"
    class="small p-1"
  >
    Reset Settings
  </button>
</div>

      </form>
    </div>
  </body>
</html>
